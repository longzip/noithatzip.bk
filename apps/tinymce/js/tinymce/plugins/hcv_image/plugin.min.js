tinymce.PluginManager.add('hcv_image', function(editor, url) {
    // Add a button that opens a window
    var hcv = 10;
    editor.addButton('hcv_image', {
        text: '',
        icon: 'image',
        onclick: function() {
            // Open window
            editor.windowManager.open({
                width: 520,
                height: 220,
                resizable: true,
                id: 'hcv-image',
                url: url + '/index.php',
                title: 'Chèn hình ảnh',
                

                buttons: [{
					text: 'Đồng ý',
					onclick: 'submit'
				},
                {
                    text: 'Hủy',
					onclick: 'close'
				}
                ],
                
                
                onsubmit: function(e) {
                    //e.preventDefault();
                    var image_url = '';
                    var image_des = '';
                    var image_align = '';
                    
                    $("#hcv-image iframe").contents().find("#image-url").each(function(){
                        image_url = $(this).val();
                    });
                    
                    $("#hcv-image iframe").contents().find("#image-des").each(function(){
                        image_des = $(this).val();
                    });
                    
                    $("#hcv-image iframe").contents().find("#image-align").each(function(){
                        image_align = $(this).val();
                    });
                    
                    
                    if(image_align == 'center')
                    {
                        var add = '<p style="text-align:center"><img src="' + image_url + '" title="' + image_des +'" alt="' + image_des +'" /></p>';
                    }
                    
                    //add += '<iframe width="560" height="315" src="//www.youtube.com/embed/' + video_id[1] + '" frameborder="0" allowfullscreen></iframe>';
                    //add += '</div>';
                    
                    if(image_align == 'left')
                    {
                        var add = '<img style="float:left" src="' + image_url + '" title="' + image_des +'" alt="' + image_des +'" />';
                    }
                    
                    if(image_align == 'right')
                    {
                        var add = '<img style="float:right" src="' + image_url + '" title="' + image_des +'" alt="' + image_des +'" />';
                    }
                    editor.insertContent(add);
                }
            });
        }
    });

    // Adds a menu item to the tools menu
    editor.addMenuItem('example', {
        text: 'Example plugin',
        context: 'tools',
        onclick: function() {
            // Open window with a specific url
            editor.windowManager.open({
                title: 'TinyMCE site',
                url: 'http://www.tinymce.com',
                width: 800,
                height: 600,
                buttons: [{
                    text: 'Close',
                    onclick: 'close'
                }]
            });
        }
    });
});