tinymce.PluginManager.add('hcv_form', function(editor, url) {
    // Add a button that opens a window
    var hcv = 10;
    editor.addButton('hcv_form', {
        text: 'Chèn form',
        icon: '',
        onclick: function() {
            // Open window
            editor.windowManager.open({
                width: 500,
                height: 240,
                resizable: true,
                id: 'hcv-form',
                url: site_url + '/admin/?page_type=tinymce-form',
                title: 'Chèn Form', 
                buttons: [{
					text: 'Chọn',
					onclick: 'submit'
				},
                {
                    text: 'Hủy',
					onclick: 'close'
				}
                ],
                
                
                onsubmit: function(e) {
                     				
                    var add = '<p></p><div class="tinymce-form clearfix">' ;
					
					  $("#hcv-form iframe").contents().find("#form-title").each(function(){
                         
                         add = add + '<div class="tinymce-form-title">' + $(this).val() + '</div>';
                         //add =  "<p></p>" + add + "<p></p>";
                        
                    });
					
                    $("#hcv-form iframe").contents().find("#html-content").each(function(){
                         
                         add = add + $(this).val();
                        
                    });
                    
                    
                    
                    
                    
                    add = add + "</div><p>&nbsp;</p>";
                    
                     
                    
                    editor.insertContent( add );
                    
					$(".opacity2").remove();
                    
                },
                onclose: function(e) { 
                    $(".opacity2").remove();                    
                }
            });
        
            var opacity2 = '<div class="opacity2"></div>';
            $("body").append(opacity2);
        }
    });

    // Adds a menu item to the tools menu
    editor.addMenuItem('example', {
        text: 'Example plugin',
        context: 'tools',
        onclick: function() {
            // Open window with a specific url
            editor.windowManager.open({
                title: 'TinyMCE site',
                url: 'http://www.tinymce.com',
                width: 800,
                height: 600,
                buttons: [{
                    text: 'Đóng',
                    onclick: 'close'
                }]
            });
        }
    });
});