tinymce.PluginManager.add('hcv_youtube', function(editor, url) {
    // Add a button that opens a window
    var hcv = 10;
    editor.addButton('hcv_youtube', {
        text: '',
        icon: 'media',
        onclick: function() {
            // Open window
            editor.windowManager.open({
                width: 450,
                height: 220,
                resizable: true,
                id: 'hcv-youtube',
                url: site_url + '/admin/?page_type=tinymce-youtube-form',
                title: 'Youtube Video',
                

                buttons: [{
					text: 'Đồng ý',
					onclick: 'submit'
				},
                {
                    text: 'Hủy',
					onclick: 'close'
				}
                ],
                
                
                onsubmit: function(e) {
                    var video_url = '';
					var video_width = 600;
					var video_height = 315;
                    var auto_play = '';
                    
                    $("#hcv-youtube iframe").contents().find("#video-url").each(function(){
                        video_url = $(this).val();
                    });
					
					$("#hcv-youtube iframe").contents().find("#video-width").each(function(){
                         video_width = $(this).val();
                    });
                    
                    $("#hcv-youtube iframe").contents().find("#auto-play").each(function(){
                         if($(this).val() == '1') auto_play = '?rel=0&amp;autoplay=1';
                    });
					
					$("#hcv-youtube iframe").contents().find("#video-height").each(function(){
                         video_height = $(this).val();
                    });
                    var video_id = video_url.split("www.youtube.com/watch?v=");
                    var real_video_id = video_id[1].split("&");
                    
                    var add = '<div style="text-align:cedfdnter">';
                    add += '<iframe width="' + video_width + '" height="' + video_height + '" src="//www.youtube.com/embed/' + real_video_id[0] + auto_play + '" frameborder="0" allowfullscreen></iframe>';
                    add += '</div>';
                    editor.insertContent("<p></p>" + add + "<p></p>");
                }
            });
        }
    });

    // Adds a menu item to the tools menu
    editor.addMenuItem('example', {
        text: 'Example plugin',
        context: 'tools',
        onclick: function() {
            // Open window with a specific url
            editor.windowManager.open({
                title: 'TinyMCE site',
                url: 'http://www.tinymce.com',
                width: 800,
                height: 600,
                buttons: [{
                    text: 'Close',
                    onclick: 'close'
                }]
            });
        }
    });
});